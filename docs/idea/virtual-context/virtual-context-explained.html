<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Context Layer - A Meta-Documentation System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #141414;
            --text-primary: #ffffff;
            --text-secondary: #888888;
            --border: #333333;
            --code-bg: #0a0a0a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 17px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 980px;
            margin: 0 auto;
            padding: 80px 20px;
        }

        h1 {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
            color: var(--text-primary);
        }

        h2 {
            font-size: 40px;
            font-weight: 600;
            margin: 80px 0 30px;
            color: var(--text-primary);
            letter-spacing: -0.01em;
        }

        h3 {
            font-size: 28px;
            font-weight: 600;
            margin: 50px 0 20px;
            color: var(--text-primary);
            letter-spacing: -0.005em;
        }

        h4 {
            font-size: 21px;
            font-weight: 600;
            margin: 30px 0 15px;
            color: var(--text-primary);
            letter-spacing: -0.003em;
        }

        p {
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .subtitle {
            font-size: 24px;
            color: var(--text-secondary);
            margin-bottom: 60px;
            font-weight: 400;
            letter-spacing: -0.005em;
        }

        .highlight {
            color: var(--text-primary);
            font-weight: 600;
        }

        .problem-solution {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }

        .problem, .solution {
            padding: 30px;
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .problem {
            background: var(--bg-tertiary);
        }

        .solution {
            background: var(--bg-tertiary);
        }

        .problem h4, .solution h4 {
            margin-top: 0;
            margin-bottom: 20px;
        }

        .problem h4 {
            color: var(--text-primary);
        }

        .solution h4 {
            color: var(--text-primary);
        }

        code {
            background: var(--code-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 6px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 0.9em;
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        pre {
            background: var(--code-bg);
            padding: 24px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 24px 0;
            border: 1px solid var(--border);
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text-primary);
            font-size: 14px;
            border: none;
        }

        .diagram {
            background: var(--code-bg);
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 14px;
            overflow-x: auto;
            border: 1px solid var(--border);
            line-height: 1.8;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin: 40px 0;
        }

        .feature-card {
            background: var(--bg-tertiary);
            padding: 32px;
            border-radius: 16px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-4px);
            border-color: var(--text-primary);
        }

        .feature-card h4 {
            color: var(--text-primary);
            margin-top: 0;
        }

        .benefit-list {
            list-style: none;
            padding: 0;
        }

        .benefit-list li {
            padding: 12px 0;
            padding-left: 32px;
            position: relative;
            color: var(--text-secondary);
        }

        .benefit-list li::before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 18px;
        }

        .timeline {
            position: relative;
            padding-left: 40px;
            margin: 40px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 40px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -40px;
            top: 8px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-primary);
            border: 2px solid var(--bg-primary);
        }

        .timeline-item h4 {
            margin-top: 0;
            color: var(--text-primary);
        }

        .tag {
            display: inline-block;
            background: var(--bg-tertiary);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            margin: 4px;
            border: 1px solid var(--border);
            font-family: 'SF Mono', Monaco, monospace;
            font-weight: 500;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }

        .comparison-item {
            padding: 32px;
            border-radius: 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
        }

        .comparison-item h4 {
            margin-top: 0;
            margin-bottom: 16px;
        }

        .comparison-item .time {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 20px;
            display: block;
            font-family: 'SF Mono', Monaco, monospace;
        }

        .footer {
            margin-top: 80px;
            padding-top: 40px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-secondary);
        }

        /* Visual Diagram Styles */
        .visual-diagram {
            margin: 40px 0;
            padding: 40px;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .tree-diagram {
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 14px;
            line-height: 2;
        }

        .tree-node {
            padding: 8px 16px;
            margin: 4px 0;
            border-radius: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            display: inline-block;
        }

        .tree-children {
            margin-left: 32px;
            border-left: 2px solid var(--border);
            padding-left: 20px;
        }

        .tree-children > div {
            position: relative;
        }

        .tree-children > div::before {
            content: '';
            position: absolute;
            left: -22px;
            top: 50%;
            width: 20px;
            height: 2px;
            background: var(--border);
        }

        .hierarchy-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .hierarchy-level {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hierarchy-box {
            padding: 16px 24px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            font-weight: 600;
            min-width: 200px;
            text-align: center;
        }

        .hierarchy-arrow {
            color: var(--text-secondary);
            font-size: 24px;
        }

        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        .flow-step {
            padding: 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            text-align: center;
            position: relative;
        }

        .flow-step::after {
            content: '‚Üì';
            position: absolute;
            bottom: -28px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-secondary);
            font-size: 20px;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .storage-diagram {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .storage-box {
            padding: 24px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .storage-box h5 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .storage-box ul {
            list-style: none;
            padding: 0;
        }

        .storage-box li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .storage-box li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .problem-solution,
            .comparison {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 40px;
            }

            h2 {
                font-size: 32px;
            }

            h3 {
                font-size: 24px;
            }

            .container {
                padding: 60px 20px;
            }

            .visual-diagram {
                padding: 24px;
            }

            .tree-children {
                margin-left: 20px;
                padding-left: 12px;
            }

            .tree-children > div::before {
                left: -14px;
                width: 12px;
            }
        }

        /* Mapping Database Styles */
        .mapping-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .mapping-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .mapping-card:hover {
            transform: translateY(-4px);
            border-color: var(--text-primary);
        }

        .mapping-card.directory-scope {
            border-left: 4px solid #3b82f6;
        }

        .mapping-card.file-scope {
            border-left: 4px solid #10b981;
        }

        .mapping-card.cross-cutting-scope {
            border-left: 4px solid #f59e0b;
        }

        .mapping-header {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 24px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .mapping-icon {
            font-size: 32px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border-radius: 12px;
        }

        .mapping-title {
            flex: 1;
        }

        .mapping-title h4 {
            margin: 0 0 8px 0;
            color: var(--text-primary);
            font-size: 18px;
        }

        .mapping-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .mapping-body {
            padding: 24px;
        }

        .mapping-flow {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .mapping-node {
            flex: 1;
            padding: 16px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .mapping-node.virtual {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
            border-color: rgba(59, 130, 246, 0.3);
        }

        .mapping-node.physical {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            border-color: rgba(16, 185, 129, 0.3);
        }

        .node-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .node-path {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 13px;
            color: var(--text-primary);
            word-break: break-all;
            line-height: 1.4;
        }

        .mapping-arrow {
            font-size: 24px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .mapping-details {
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .detail-item {
            margin-bottom: 16px;
        }

        .detail-label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 13px;
            color: var(--text-primary);
        }

        .detail-value.multi-target {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .detail-value.multi-target span {
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .detail-tags .tag {
            margin: 0;
        }

        @media (max-width: 768px) {
            .mapping-flow {
                flex-direction: column;
            }

            .mapping-arrow {
                transform: rotate(90deg);
            }

            .mapping-header {
                padding: 16px;
            }

            .mapping-body {
                padding: 16px;
            }

            .detail-value.multi-target {
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Virtual Context Layer</h1>
        <p class="subtitle">A Meta-Documentation System for AI-Assisted Development</p>

        <h2>The Core Problem</h2>
            <p>As AI becomes more integrated into development workflows, we're seeing an explosion of context documents:</p>
            <ul class="benefit-list">
                <li>Feature specifications</li>
                <li>Implementation guides</li>
                <li>Architecture decisions</li>
                <li>Domain knowledge</li>
                <li>Rules and constraints</li>
                <li>Testing strategies</li>
                <li>Migration guides</li>
            </ul>

            <div class="problem-solution">
                <div class="problem">
                    <h4>Current Reality</h4>
                    <p>These documents either:</p>
                    <ul class="benefit-list">
                        <li>Live far from code (in <code>/docs</code>) - hard to discover, easy to forget</li>
                        <li>Clutter the codebase - inline comments become novels, README files everywhere</li>
                        <li>Get out of sync - documentation drifts from implementation</li>
                    </ul>
                </div>
                <div class="solution">
                    <h4>The Vision</h4>
                    <p><strong>Virtual Colocation</strong></p>
                    <p>What if documentation could be "virtually" colocated with code without physically being there?</p>
                    <p>Think of it like:</p>
                    <ul class="benefit-list">
                        <li><strong>Git</strong> - tracks changes without storing full copies</li>
                        <li><strong>Symbolic links</strong> - point to content elsewhere</li>
                        <li><strong>Virtual file systems</strong> - present a unified view of distributed content</li>
                    </ul>
                </div>
        </div>

        <h2>Conceptual Model</h2>
        
        <h3>Physical vs Virtual Reality</h3>
        <p><strong>Physical Storage</strong> (centralized, organized):</p>
        <div class="visual-diagram">
            <div class="tree-diagram">
                <div class="tree-node">.promptstack/</div>
                <div class="tree-children">
                    <div>
                        <div class="tree-node">context/</div>
                        <div class="tree-children">
                            <div>
                                <div class="tree-node">domains/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">ai-domain-overview.md</div></div>
                                    <div><div class="tree-node">storage-domain-overview.md</div></div>
                                    <div><div class="tree-node">editor-domain-overview.md</div></div>
                                </div>
                            </div>
                            <div>
                                <div class="tree-node">implementations/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">ai-provider-interface.md</div></div>
                                    <div><div class="tree-node">claude-implementation-guide.md</div></div>
                                    <div><div class="tree-node">repository-pattern-guide.md</div></div>
                                </div>
                            </div>
                            <div>
                                <div class="tree-node">architecture/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">error-handling-strategy.md</div></div>
                                    <div><div class="tree-node">dependency-injection-pattern.md</div></div>
                                    <div><div class="tree-node">interface-design-principles.md</div></div>
                                </div>
                            </div>
                            <div>
                                <div class="tree-node">features/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">placeholder-system-design.md</div></div>
                                    <div><div class="tree-node">vim-mode-architecture.md</div></div>
                                    <div><div class="tree-node">history-sync-strategy.md</div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <p><strong>Virtual View</strong> (in IDE/AI, colocated with code):</p>
        <div class="visual-diagram">
            <div class="tree-diagram">
                <div class="tree-node">src/</div>
                <div class="tree-children">
                    <div>
                        <div class="tree-node">internal/</div>
                        <div class="tree-children">
                            <div>
                                <div class="tree-node">ai/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">üìÑ domain-overview.md <span style="color: var(--text-secondary); font-size: 12px;">‚Üê Directory-level</span></div></div>
                                    <div><div class="tree-node">provider.go</div></div>
                                    <div><div class="tree-node">üìÑ provider-interface.md <span style="color: var(--text-secondary); font-size: 12px;">‚Üê File-level</span></div></div>
                                    <div><div class="tree-node">claude.go</div></div>
                                    <div><div class="tree-node">üìÑ claude-implementation.md <span style="color: var(--text-secondary); font-size: 12px;">‚Üê File-level</span></div></div>
                                </div>
                            </div>
                            <div>
                                <div class="tree-node">storage/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">üìÑ domain-overview.md</div></div>
                                    <div><div class="tree-node">repository.go</div></div>
                                    <div><div class="tree-node">üìÑ repository-pattern.md</div></div>
                                </div>
                            </div>
                            <div>
                                <div class="tree-node">editor/</div>
                                <div class="tree-children">
                                    <div><div class="tree-node">üìÑ domain-overview.md</div></div>
                                    <div><div class="tree-node">buffer.go</div></div>
                                    <div><div class="tree-node">placeholder.go</div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <h2>The Mapping Database</h2>
            <p>A lightweight index tracking relationships between virtual and physical context:</p>
            
            <div class="visual-diagram">
                <div class="mapping-container">
                    <!-- Domain-level mapping -->
                    <div class="mapping-card directory-scope">
                        <div class="mapping-header">
                            <div class="mapping-icon">üìÅ</div>
                            <div class="mapping-title">
                                <h4>Directory-Level Context</h4>
                                <span class="mapping-badge">Applies to entire directory</span>
                            </div>
                        </div>
                        <div class="mapping-body">
                            <div class="mapping-flow">
                                <div class="mapping-node virtual">
                                    <div class="node-label">Virtual Path</div>
                                    <div class="node-path">src/internal/ai/domain-overview.md</div>
                                </div>
                                <div class="mapping-arrow">‚Üí</div>
                                <div class="mapping-node physical">
                                    <div class="node-label">Physical Path</div>
                                    <div class="node-path">.promptstack/context/domains/ai-domain-overview.md</div>
                                </div>
                            </div>
                            <div class="mapping-details">
                                <div class="detail-item">
                                    <span class="detail-label">Target:</span>
                                    <span class="detail-value">src/internal/ai/</span>
                                </div>
                                <div class="detail-tags">
                                    <span class="tag">architecture</span>
                                    <span class="tag">ai</span>
                                    <span class="tag">domain</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- File-level mapping -->
                    <div class="mapping-card file-scope">
                        <div class="mapping-header">
                            <div class="mapping-icon">üìÑ</div>
                            <div class="mapping-title">
                                <h4>File-Level Context</h4>
                                <span class="mapping-badge">Specific to one file</span>
                            </div>
                        </div>
                        <div class="mapping-body">
                            <div class="mapping-flow">
                                <div class="mapping-node virtual">
                                    <div class="node-label">Virtual Path</div>
                                    <div class="node-path">src/internal/ai/provider-interface.md</div>
                                </div>
                                <div class="mapping-arrow">‚Üí</div>
                                <div class="mapping-node physical">
                                    <div class="node-label">Physical Path</div>
                                    <div class="node-path">.promptstack/context/implementations/ai-provider-interface.md</div>
                                </div>
                            </div>
                            <div class="mapping-details">
                                <div class="detail-item">
                                    <span class="detail-label">Target:</span>
                                    <span class="detail-value">src/internal/ai/provider.go</span>
                                </div>
                                <div class="detail-tags">
                                    <span class="tag">interface</span>
                                    <span class="tag">abstraction</span>
                                    <span class="tag">scalability</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cross-cutting mapping -->
                    <div class="mapping-card cross-cutting-scope">
                        <div class="mapping-header">
                            <div class="mapping-icon">üîó</div>
                            <div class="mapping-title">
                                <h4>Cross-Cutting Context</h4>
                                <span class="mapping-badge">Applies to multiple locations</span>
                            </div>
                        </div>
                        <div class="mapping-body">
                            <div class="mapping-flow">
                                <div class="mapping-node virtual">
                                    <div class="node-label">Virtual Path</div>
                                    <div class="node-path">error-handling-strategy.md</div>
                                </div>
                                <div class="mapping-arrow">‚Üí</div>
                                <div class="mapping-node physical">
                                    <div class="node-label">Physical Path</div>
                                    <div class="node-path">.promptstack/context/architecture/error-handling-strategy.md</div>
                                </div>
                            </div>
                            <div class="mapping-details">
                                <div class="detail-item">
                                    <span class="detail-label">Targets:</span>
                                    <div class="detail-value multi-target">
                                        <span>src/internal/platform/errors/</span>
                                        <span>src/internal/ai/client.go:handleAPIError</span>
                                        <span>src/ui/*/error handling</span>
                                    </div>
                                </div>
                                <div class="detail-tags">
                                    <span class="tag">architecture</span>
                                    <span class="tag">error-handling</span>
                                    <span class="tag">cross-cutting</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="visual-diagram" style="margin-top: 30px;">
                <h4 style="margin-bottom: 20px; color: var(--text-primary);">How It Works</h4>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <strong>1. Define Mapping</strong><br>
                        <span style="color: var(--text-secondary);">Create entry in context-map.yaml</span>
                    </div>
                    <div class="flow-step">
                        <strong>2. Virtual Resolution</strong><br>
                        <span style="color: var(--text-secondary);">AI requests virtual path</span>
                    </div>
                    <div class="flow-step">
                        <strong>3. Physical Lookup</strong><br>
                        <span style="color: var(--text-secondary);">System maps to physical file</span>
                    </div>
                    <div class="flow-step">
                        <strong>4. Content Delivery</strong><br>
                        <span style="color: var(--text-secondary);">Return context to AI</span>
                    </div>
                </div>
            </div>

        <h2>Context Hierarchy & Inheritance</h2>
        
        <h3>Multi-level Context</h3>
        <div class="visual-diagram">
            <div class="hierarchy-diagram">
                <div class="hierarchy-level">
                    <div class="hierarchy-box">Project Level</div>
                </div>
                <div class="hierarchy-arrow">‚Üì</div>
                <div class="hierarchy-level">
                    <div class="hierarchy-box">Domain Level<br><span style="font-size: 14px; color: var(--text-secondary); font-weight: 400;">src/internal/ai/</span></div>
                </div>
                <div class="hierarchy-arrow">‚Üì</div>
                <div class="hierarchy-level">
                    <div class="hierarchy-box">File Level<br><span style="font-size: 14px; color: var(--text-secondary); font-weight: 400;">provider.go</span></div>
                </div>
                <div class="hierarchy-arrow">‚Üì</div>
                <div class="hierarchy-level">
                    <div class="hierarchy-box">Symbol Level<br><span style="font-size: 14px; color: var(--text-secondary); font-weight: 400;">AIProvider interface</span></div>
                </div>
            </div>
        </div>

        <h3>Context Resolution</h3>
        <p>When AI requests context for <code>src/internal/ai/claude.go</code>:</p>
        <div class="visual-diagram">
            <div class="flow-diagram">
                <div class="flow-step">
                    <strong>1. Project-level</strong><br>
                    <span style="color: var(--text-secondary);">Architecture, conventions, style guide</span>
                </div>
                <div class="flow-step">
                    <strong>2. Domain-level</strong><br>
                    <span style="color: var(--text-secondary);">AI domain overview, patterns</span>
                </div>
                <div class="flow-step">
                    <strong>3. File-level</strong><br>
                    <span style="color: var(--text-secondary);">Claude implementation guide</span>
                </div>
                <div class="flow-step">
                    <strong>4. Inherited</strong><br>
                    <span style="color: var(--text-secondary);">Provider interface design (from parent)</span>
                </div>
                <div class="flow-step">
                    <strong>5. Related</strong><br>
                    <span style="color: var(--text-secondary);">Other AI provider implementations</span>
                </div>
            </div>
        </div>

        <h2>Key Features</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Directory Scope</h4>
                    <p>Applies to all files in directory and subdirectories. Perfect for domain overviews and architectural patterns.</p>
                    <span class="tag">Architecture</span>
                    <span class="tag">Domain</span>
                </div>
                
                <div class="feature-card">
                    <h4>File Scope</h4>
                    <p>Specific to one source file. Implementation guides and file-specific decisions.</p>
                    <span class="tag">Implementation</span>
                    <span class="tag">Guide</span>
                </div>
                
                <div class="feature-card">
                    <h4>Symbol Scope</h4>
                    <p>Attached to specific functions, types, interfaces. Design rationale and usage examples.</p>
                    <span class="tag">Function</span>
                    <span class="tag">Type</span>
                </div>
                
                <div class="feature-card">
                    <h4>Cross-Cutting Scope</h4>
                    <p>Applies to multiple unrelated locations. Architectural patterns and conventions.</p>
                    <span class="tag">Pattern</span>
                    <span class="tag">Convention</span>
                </div>
            </div>

            <h3>Dynamic Context Assembly</h3>
            <p>When AI needs context, the system assembles it dynamically:</p>
            <div class="visual-diagram">
                <div class="flow-diagram">
                    <div class="flow-step">
                        <strong>Request</strong><br>
                        <span style="color: var(--text-secondary);">Context for src/internal/ai/claude.go</span>
                    </div>
                    <div class="flow-step">
                        <strong>1. Load project-level</strong><br>
                        <span style="color: var(--text-secondary);">Architecture, conventions</span>
                    </div>
                    <div class="flow-step">
                        <strong>2. Load domain-level</strong><br>
                        <span style="color: var(--text-secondary);">AI domain overview</span>
                    </div>
                    <div class="flow-step">
                        <strong>3. Load file-level</strong><br>
                        <span style="color: var(--text-secondary);">Claude implementation guide</span>
                    </div>
                    <div class="flow-step">
                        <strong>4. Load inherited</strong><br>
                        <span style="color: var(--text-secondary);">Provider interface design</span>
                    </div>
                    <div class="flow-step">
                        <strong>5. Load related</strong><br>
                        <span style="color: var(--text-secondary);">Other provider implementations</span>
                    </div>
                    <div class="flow-step">
                        <strong>6. Apply filters</strong><br>
                        <span style="color: var(--text-secondary);">Relevance, token budget</span>
                    </div>
                    <div class="flow-step">
                        <strong>7. Return assembled</strong><br>
                        <span style="color: var(--text-secondary);">Complete context package</span>
                    </div>
                </div>
            </div>

        <h2>Benefits</h2>
            
            <h3>For Developers</h3>
            <ul class="benefit-list">
                <li><strong>Clean Codebase</strong> - No documentation clutter in source files</li>
                <li><strong>Discoverable Context</strong> - IDE shows virtual docs alongside code</li>
                <li><strong>Versioned with Code</strong> - Context map is version controlled</li>
                <li><strong>Easy to Maintain</strong> - Centralized documentation storage</li>
            </ul>

            <h3>For AI</h3>
            <ul class="benefit-list">
                <li><strong>Rich Context</strong> - Access deep documentation without bloating prompts</li>
                <li><strong>Contextual Awareness</strong> - Knows what docs are relevant to current file</li>
                <li><strong>Relationship Understanding</strong> - Sees connections between code and concepts</li>
                <li><strong>Efficient Token Usage</strong> - Loads only relevant context</li>
            </ul>

            <h3>For Teams</h3>
            <ul class="benefit-list">
                <li><strong>Consistent Documentation</strong> - Centralized, easier to maintain standards</li>
                <li><strong>Onboarding</strong> - New devs see context right where they need it</li>
                <li><strong>Knowledge Preservation</strong> - Architectural decisions stay linked to code</li>
                <li><strong>Collaboration</strong> - Shared understanding of complex systems</li>
            </ul>

        <h2>Integration with Project OS</h2>
            <p>The Virtual Context Layer concept and Project OS vision are <strong>naturally complementary</strong>. They solve different aspects of the same fundamental problem: making organizational and technical knowledge accessible, queryable, and actionable.</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Virtual Context Layer</h4>
                    <p>Provides the <strong>mechanism</strong> for colocating documentation with code.</p>
                </div>
                
                <div class="feature-card">
                    <h4>Project OS</h4>
                    <p>Provides the <strong>intelligence</strong> for understanding and querying that context.</p>
                </div>
                
                <div class="feature-card">
                    <h4>PromptStack</h4>
                    <p>Provides the <strong>interface</strong> for composing and interacting with both.</p>
                </div>
            </div>

            <h3>Context as MCP Resources</h3>
            <p>Virtual context documents become <strong>MCP resources</strong> that specialist servers can query:</p>
            <pre><code>mappings:
  - virtual_path: "src/internal/ai/provider.md"
    physical_path: ".promptstack/context/ai-provider-interface.md"
    
    # MCP resource metadata
    mcp_resource:
      uri: "context://src/internal/ai/provider.md"
      mime_type: "text/markdown"
      specialists: ["code-intel", "architecture"]
      
    # Semantic metadata for specialist routing
    semantic:
      concepts: ["interface-design", "abstraction", "dependency-injection"]
      domain: "ai"
      complexity: "medium"
      business_impact: "high"</code></pre>

        <h2>Context Specialists</h2>
            <p>Each domain specialist has its own context corpus:</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Code Intelligence Server</h4>
                    <p><strong>Corpus:</strong> AST fingerprints, implementation patterns<br>
                    <strong>Context:</strong> "How to implement X pattern"</p>
                </div>
                
                <div class="feature-card">
                    <h4>Tax Specialist Server</h4>
                    <p><strong>Corpus:</strong> Tax regulations, calculation rules<br>
                    <strong>Context:</strong> "Tax implications of this feature"</p>
                </div>
                
                <div class="feature-card">
                    <h4>Security Specialist Server</h4>
                    <p><strong>Corpus:</strong> Security best practices, vulnerability patterns<br>
                    <strong>Context:</strong> "Security considerations for this code"</p>
                </div>
                
                <div class="feature-card">
                    <h4>Architecture Specialist Server</h4>
                    <p><strong>Corpus:</strong> Design patterns, architectural decisions<br>
                    <strong>Context:</strong> "Why we chose this architecture"</p>
                </div>
            </div>

        <h2>Context Storage: Local + Remote Hybrid</h2>
        <p>Support both local files (for personal/team context) and remote databases (for organizational knowledge).</p>
        
        <div class="visual-diagram">
            <div class="storage-diagram">
                <div class="storage-box">
                    <h5>Local Filesystem</h5>
                    <ul>
                        <li>Developer-specific notes</li>
                        <li>Team conventions</li>
                        <li>Project documentation</li>
                        <li>Fast, private, always available</li>
                    </ul>
                </div>
                <div class="storage-box">
                    <h5>Remote PostgreSQL</h5>
                    <ul>
                        <li>Domain specialists (Tax, Security)</li>
                        <li>Company-wide patterns</li>
                        <li>Business context & ROI data</li>
                        <li>Centralized, queryable</li>
                    </ul>
                </div>
                <div class="storage-box">
                    <h5>Graph Database (Neo4j)</h5>
                    <ul>
                        <li>Code ‚Üí Context links</li>
                        <li>Context ‚Üí Context links</li>
                        <li>Business ‚Üí Code links</li>
                        <li>Relationship network</li>
                    </ul>
                </div>
            </div>
        </div>

        <h2>Use Cases</h2>
            
            <h3>Use Case 1: Developer Implements New Feature</h3>
            <p><strong>Scenario:</strong> Developer needs to add Canadian tax support to billing system.</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h4>Traditional Workflow</h4>
                    <span class="time">‚è±Ô∏è 2-3 hours</span>
                    <ul class="benefit-list">
                        <li>Search Slack for "Canadian tax"</li>
                        <li>Ask team lead for context</li>
                        <li>Read through old PRs</li>
                        <li>Hunt for related code</li>
                        <li>Hope documentation is up to date</li>
                    </ul>
                </div>
                
                <div class="comparison-item">
                    <h4>With Virtual Context Layer</h4>
                    <span class="time">‚è±Ô∏è 15 minutes</span>
                    <ul class="benefit-list">
                        <li>Open <code>src/billing/calculator.go</code></li>
                        <li>System automatically shows relevant context</li>
                        <li>Tax specialist context (Canadian GST/HST rules)</li>
                        <li>Implementation graph node (acceptance criteria)</li>
                        <li>Related code patterns and security considerations</li>
                        <li>Compose prompt with <code>{{context:auto}}</code></li>
                    </ul>
                </div>
            </div>

            <h3>Use Case 2: Product Manager Plans Feature</h3>
            <p><strong>Scenario:</strong> PM needs to understand feasibility and effort for new feature.</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h4>Traditional Workflow</h4>
                    <span class="time">‚è±Ô∏è 1-2 weeks</span>
                    <ul class="benefit-list">
                        <li>Schedule meetings with architects</li>
                        <li>Wait for technical assessment</li>
                        <li>Get rough estimates</li>
                        <li>Iterate on requirements</li>
                    </ul>
                </div>
                
                <div class="comparison-item">
                    <h4>With Virtual Context Layer</h4>
                    <span class="time">‚è±Ô∏è 1-2 days</span>
                    <ul class="benefit-list">
                        <li>Query implementation graph: "What's needed for feature X?"</li>
                        <li>Graph nodes with effort estimates</li>
                        <li>Dependencies and blockers</li>
                        <li>Business context and ROI</li>
                        <li>Related work and patterns</li>
                    </ul>
                </div>
            </div>

            <h3>Use Case 3: New Developer Onboarding</h3>
            <p><strong>Scenario:</strong> New developer joins team, needs to understand codebase.</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h4>Traditional Workflow</h4>
                    <span class="time">‚è±Ô∏è 2-4 weeks to productivity</span>
                    <ul class="benefit-list">
                        <li>Read outdated README</li>
                        <li>Ask team members questions</li>
                        <li>Explore code randomly</li>
                        <li>Make mistakes, learn slowly</li>
                    </ul>
                </div>
                
                <div class="comparison-item">
                    <h4>With Virtual Context Layer</h4>
                    <span class="time">‚è±Ô∏è 3-5 days to productivity</span>
                    <ul class="benefit-list">
                        <li>Clone repo with context layer</li>
                        <li>Browse virtual context alongside code</li>
                        <li>See business context for each file</li>
                        <li>Query specialists for explanations</li>
                        <li>Follow implementation graphs for features</li>
                    </ul>
                </div>
            </div>

        <h2>Implementation Roadmap</h2>
            
            <div class="timeline">
                <div class="timeline-item">
                    <h4>Phase 1: Foundation (Months 1-3)</h4>
                    <p>Establish basic virtual context layer with local storage</p>
                    <ul class="benefit-list">
                        <li>Implement context mapping format (YAML)</li>
                        <li>Build context resolution engine</li>
                        <li>Add CLI commands for context management</li>
                        <li>Integrate with PromptStack composition workspace</li>
                    </ul>
                </div>
                
                <div class="timeline-item">
                    <h4>Phase 2: MCP Integration (Months 4-6)</h4>
                    <p>Connect context layer to MCP specialist servers</p>
                    <ul class="benefit-list">
                        <li>Define MCP resource protocol for context</li>
                        <li>Implement context as MCP resources</li>
                        <li>Build specialist context contribution system</li>
                        <li>Add semantic metadata for routing</li>
                    </ul>
                </div>
                
                <div class="timeline-item">
                    <h4>Phase 3: Remote Storage (Months 7-9)</h4>
                    <p>Add PostgreSQL and Neo4j support for organizational knowledge</p>
                    <ul class="benefit-list">
                        <li>Implement PostgreSQL context source</li>
                        <li>Add Neo4j graph relationships</li>
                        <li>Build context synchronization</li>
                        <li>Add caching layer and offline-first mode</li>
                    </ul>
                </div>
                
                <div class="timeline-item">
                    <h4>Phase 4: Graph Integration (Months 10-12)</h4>
                    <p>Integrate implementation planning graphs as context</p>
                    <ul class="benefit-list">
                        <li>Define graph-as-context format</li>
                        <li>Build graph query engine</li>
                        <li>Add @ref tag bidirectional linking</li>
                        <li>Implement graph context in prompts</li>
                    </ul>
                </div>
                
                <div class="timeline-item">
                    <h4>Phase 5: Intelligence Layer (Months 13-15)</h4>
                    <p>Add AI-powered context features</p>
                    <ul class="benefit-list">
                        <li>Implement context-aware suggestions</li>
                        <li>Build context quality metrics</li>
                        <li>Add automatic context generation</li>
                        <li>Create context health dashboard</li>
                    </ul>
                </div>
            </div>

        <h2>Challenges & Solutions</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Context Staleness</h4>
                    <p><strong>Solutions:</strong> Git hooks, automated staleness detection, context version tracking, AI-powered updates</p>
                </div>
                
                <div class="feature-card">
                    <h4>Context Overload</h4>
                    <p><strong>Solutions:</strong> Hierarchical context, smart filtering, token budget management, context summarization</p>
                </div>
                
                <div class="feature-card">
                    <h4>IDE Integration</h4>
                    <p><strong>Solutions:</strong> LSP protocol extension, IDE-agnostic CLI tools, web-based context viewer</p>
                </div>
                
                <div class="feature-card">
                    <h4>Context Conflicts</h4>
                    <p><strong>Solutions:</strong> Context precedence rules, conflict detection, version tracking, explicit overrides</p>
                </div>
                
                <div class="feature-card">
                    <h4>Performance</h4>
                    <p><strong>Solutions:</strong> Context index caching, lazy loading, incremental updates, parallel resolution</p>
                </div>
            </div>

        <h2>The Vision</h2>
            <p>A world where:</p>
            <ul class="benefit-list">
                <li>Developers never hunt for context</li>
                <li>Business knowledge is always accessible</li>
                <li>AI assistance is truly context-aware</li>
                <li>Organizational memory is preserved and queryable</li>
            </ul>
            
            <p style="margin-top: 2rem; font-size: 1.1rem; color: var(--text-primary);">
                This isn't just better documentation‚Äîit's a <strong>new way of working</strong> where context flows naturally from business to code and back again.
            </p>

        <h2>Next Steps</h2>
            <ol class="benefit-list">
                <li><strong>Prototype context mapping format</strong> - Define YAML schema</li>
                <li><strong>Build minimal CLI</strong> - Basic context commands</li>
                <li><strong>Integrate with PromptStack</strong> - Context placeholders</li>
                <li><strong>Test with real project</strong> - Apply to PromptStack itself</li>
                <li><strong>Gather feedback</strong> - Validate with developers</li>
                <li><strong>Iterate on design</strong> - Refine based on usage</li>
            </ol>
            
            <p style="margin-top: 2rem;">
                <strong>Status:</strong> Concept exploration - ready for prototyping
            </p>

        <div class="footer">
            <p>Virtual Context Layer ‚Ä¢ A Meta-Documentation System for AI-Assisted Development</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Created: January 7, 2026</p>
        </div>
    </div>
</body>
</html>